# 캐시최적화

## 1. 캐시

- 캐시: 콘텐츠 요청에 빠르게 응답위해 서버-클라이언트 사이 응답 콘텐츠의 사본 저장하는 공간
  - 사용자의 같은 요청에 응답하는 리소스 동일시 이용
  - 서버-클라이언트 사이에 존재, 서버 성능향상시키는 역할
  - 웹의 경우 HTML, CSS, JS 등 정적 콘텐츠 많음
- 캐시 서버: 캐시를 유지, 처리하는 별도의 서버
  - 캐시서버의 종류
    - > 기능상 차이 있으나 캐시 컨트롤 기본 원리는 동일
    - 브라우저 캐시(로컬캐시)
      - 브라우저에 위치
      - 한번 다운한 리소스를 재사용해 사이트 로딩 빠르게 함
    - 프록시 캐시
      - 브라우저와 ISP에 위치
      - 조직내 사용자가 접속하는 웹 사이트 리소스 캐시해 네트워크 연결과 대역폭 사용률 감소, 사용자 웹 사이트로딩 빠르게 함
    - 트랜스패어런트 캐시
      - ISP에 위치
      - ISP에서 이를 사용해 ISP간 대역폭 낭비 방지
    - 리버스 프록시 캐시(웹 캐시)
      - ISP와 웹서버에 위치
      - 원본 서버로 향하는 트래픽 대역폭 감소&사용자 응답 개선
      - 서버에서 성능향상위해 별도로 사용
      - 웹 캐시: 리버스 프록시 서버(웹서버)에 캐시 기능 추가해 리버스 프록시 캐시서버로 이용
        - Apache HTTP Server: mod_cache, mod_cache_disk, mod_file_cache 모듈 활성화해 캐시서버로 활용 가능
        - Apache Traffic Server: 오픈소스 웹 캐시서버, 성능&확장성 뛰어난 웹 캐시 서버
        - Nginx: 웹 서버 중 하나로 콘텐츠 캐시 기능 제공
        - Varnish Cache: 캐시 통한 HTTP가속 목적으로 개발된 오픈소스 소프트웨어, 캐시 및 가속 기능 제공

## 2. 웹 캐시 동작 원리

- 웹 캐시
  - 웹 서버와 웹 브라우저의 중간에 위치, 최초 원본 콘텐츠 요청을 최종서버에 보내 응답받고 복사본 만들어 저장해 사용자에게 응답
  - 같은 콘텐츠 요청 시 복사본을 사용자에게 전달
  - > 원본서버로의 트래픽 줄이고 사용자 요청대한 반응속도 향상
  - 모든 웹 콘텐츠 캐시는 불가
    - 개인정보 보호
  - 콘텐츠 변경시 감지하여 원본서버에 요청
- 캐시서버: HTTP/1.1 규격을 기반으로 동작
- HTTP
  - 인터넷에서 데이터 주고받기 위한 클라이언트/서버 모델의 프로토콜
    - 클라이언트가 특정 URL 요청을 서버에 전달
    - 서버에서 요청 처리해 URL에 해당하는 응답 클라이언트에게 전달
    - 브라우저(클라이언트) / 웹서버(서버) / 프록시서버(클라이언트 / 서버)
  - OSI 7계층의 Application 레벨 프로토콜, TCP/IP위에서 동작
  - TCP Connection 맺어지면 HTTP는 어떤 종류의 데이터든 전송가능
  - > 특징
    - 클라이언트 서버 모델
    - 비연결성, 상태유지않는 프로토콜 (Connectionless, Stateless)
    - 클라이언트와 서버간 HTTP메세지 주고받으며 통신
    - HTTP 메세지 = 헤더 + 바디
    - TransportLayer프로토콜로 TCP사용, 일반적으로 80포트(SSL은 443포트)
  - HTTP메세지
    - 헤더: 메세지 전송 및 처리에 필요한 데이터 -메세지 전송할 호스트명, URL패스...
    - 페이로드: 서버가 실제 전송하려는 데이터
      - html, 이미지 ...
