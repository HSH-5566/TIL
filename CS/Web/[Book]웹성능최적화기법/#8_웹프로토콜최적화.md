# 웹 프로토콜 최적화

## 1. HTTP의 발전

### HTTP/0.9

- GET 메소드만 존재
- 텍스트만 읽을 수 있음
- 클라이언트 정보 서버에 전달 불가

### HTTP/1.0

- POST 메소드: 클라이언트 정보 웹서버로 전달
- Content-Type헤더 통해 이미지 등 전달가능
- 헤더 통해 클라이언트와 서버 정보 전달 가능
- Content-Encoding 헤더 통해 클라이언트-서버 간 지원하는 압축 알고리즘 공유

### HTTP/1.1

- PUT, DELETE 메소드: 파일 업로드, 웹 서버 내용 삭제
- Via 헤더: 중계서버 정보 공유
- Accept 헤더: 클라이언트가 지원하는 콘텐츠 형식 서버에 알림
- 지속적 연결 기술: 하나의 TCP연결 재사용해 많은 콘텐츠 전달 가능
- 파이프라이닝 기술
  - 브라우저가 웹 서버에 여러 콘텐츠 요청
  - 이전 요청대한 응답 완전히 받지 않아도 지속적 연결로 확보한 하나의 TCP 연결 내에서 미리 다음 요청에 대한 처리를 시작하여 전체적인 전달 시간 줄이는 방식
- HOL 문제
  - 클라이언트-서버 통신에 순서가 존재 -> 서버가 하나의 요청에 응답을 지연하면 나머지 모든 요청 지연

### HTTP/2

- 이진포맷 이용: 기존 텍스트 방식의 프로토콜 메세지 대신 이용해 프로토콜 자체를 경량화
  - ex`)` HTTP/1.1: 헤더 + 페이로드 => HTTP/2: 헤더 프레임 + 데이터 프레임
- 멀티플렉싱 / 스트림 우선순위 결정 / 헤더압축(HPACK) / 서버푸시 등 프로토콜 최적화 기술 추가
- HTTP의 HOL 문제 해결
- TCP의 HOL 문제 미해결

### HTTP/3

- QUIC 사용: 새로운 인터넷 프로토콜
- UDP 사용: TCP보다 최적화하기 더 쉬운 구조
- 클라이언트-HTTP/3 서버 사이의 QUIC연결 최대한 재사용하는 구조: 클라이언트-서버 간 연결 시간 대폭 감소

## 2. HTTP/2의 최적화 기술

- 클라이언트-서버 콘텐츠 전달 속도 감소 및 서버 응답 느린 콘텐츠가 다른 정상 콘텐츠 전달 방해않는 것 목표
  - 문자열 방식의 프로토콜 -> 이진 프레임: 더 가볍고 유연한 프로토콜
  - HTTP요청, 응답에 포함된 중복 헤더 거름 & 압축: 헤더 크기 최소화
  - 서버 푸시: RTT 최소화

### HTTP/2의 이진 프레임

- 프레임: HTTP/2 통신상 제일 작은 정보단위로 헤더나 데이터 중 하나
- 메시지: HTTP/1.1과 같이 요청 또는 응답단위로 다수의 프레임으로 구성
- 스트림: 클라이언트-서버사이 연결 통해 양방향으로 주고받는 하나, 복수의 메시지
- 프레임多 -> 메시지多 -> 스트림

### 멀티플렉싱

- HTTP/1.1의 파이프라이닝 기능 개선
- 스트림으로 서버에서 만들어진 응답 프레임이 요청순서에 상관없이 만들어진 순서대로 클라이언트에 전달
- 하나의 TCP 연결상에서 다수의 클라이언트 요청, 서버 응답이 비동기 방식으로 이루어지는 기술
- HOL문제 해결
- 병목현상 회피

### 헤더압축

- 클라이언트-서버 사이 가상 테이블 생성해 중복되는 헤더 값을 테이블에 저장 및 참고하여 중복전달 제거
- 가상 테이블
  - 정적 테이블: 미리 정의된 헤더 필드 저장
  - 동적 테이블: 클라이언트-서버가 통신하며 주고받는 값 업데이트
- 헤더 압축 알고리즘 HPACK: 허프만 알고리즘 방식

### 서버푸시

- 클라이언트 요청없이 서버가 여러응답 알아서 전송
- 클라이언트가 특정 콘텐츠 요청 시 서버가 이후 추가 요청을 예상하고 요청없이도 응답
- 서버푸시대상 웹 서버 관리자, 개발자가 지정가능
  - HTTP/2 지원하는 웹서버에 서버푸시 대상 설정 가능
  - APM 솔루션 통해 서버푸시대상 자동 설정

## 3. HTTP/3의 최적화 기술

### QUIC

- UDP를 채택해 TCP의 성능을 개선하려는 기술
- 전달속도 향상 / 클라이언트-서버 연결 수 최소화 / 대역폭 예상통한 패킷 혼잡 회피

### HTTP/3의 등장 배경

- QUIC: TCP의 높은 신뢰성 + UDP의 빠른 성능
- TCP가 가지고 있는 HTTP/2의 단점 보완에 중점

### HTTP/3의 특징

- TCP/IP기반 애플리케이션 레이어 프로토콜인 HTTP를 QUIC위로 위치 시킴: HQ(HTTP over QUIC)
  - TCP의 일종이던 HTTP가 UDP기반의 QUIC로 변경
- UDP기반 QUIC 통한 성능 개선 / TLS 1.3 버전 업그레이드 통한 성능 및 보안 개선
