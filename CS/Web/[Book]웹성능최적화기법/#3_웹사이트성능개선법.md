# 웹사이트 성능을 개선하는 기본적인 방법
## 1. HTTP요청 수 줄이기
- 크롬 - 개발자도구 - Network: 웹 페이지에서 요청하는 콘텐츠 확인가능
- 클라이언트(브라우저)와 웹서버 소통방식
    - 브라우저가 DNS 시스템으로 특정 도메인의 접속IP알아내 접속
    - HTML 파일 먼저 응답 받은 후 CSS, JS, 이미지,,, 콘텐츠 호출
    - 브라우저가 HTML 모두 해석해 콘텐츠 전부 받아올때까지 호출수행
    - > 조회된 웹 서버IP 통해 브라우저와 웹서버간 TCP/IP 연결 후 콘텐츠 다운
- 요청 콘텐츠 많으면 로딩 완료시간 증가 -> 웹성능위해 HTTP요청수 줄이기
- 페이지 콘텐츠 유지하며 HTTP요청 수 줄이는 방법
    1. 스크립트 파일 병합
        - JS, CSS의 모듈화(정복과 분할)는 HTTP요청 증가시킴
        - >모듈화된 여러 파일 병합해 HTTP요청 감소
            - 단, 합쳐진 파일의 크기가 너무 크면 해당 파일다운 및 렌더링 시간 길어지므로 적절한 크기유지
        - >인터넷 상 프록시나 브라우저에 캐시될 확률 높임
            - 웹서버보다 캐시된 콘텐츠 이용하는 것이 빠름
    2. 인라인 이미지
        - !인라인 이미지: HTML파일의 CSS안에 해시정보 통해 이미지 파일 삽입
            - HTML 파일 바이트 크기 소폭 증가
            - 전통적인 방식(이미지 파일 호출 및 크기만큼 파일 다운)과 비교시 전체로딩시간 단축
            - 별도의 이미지 파일 미존재 => 인터넷, 브라우저 캐시 불가, HTML 캐시시 동시 캐싱
            - > 전반적인 성능개선 여부 확인하고 선택 사용
    3. CSS 스프라이트
        - !CSS 스프라이트: 여러 이미지를 하나의 이미지 파일로 결합, 필요 이미지의 픽셀좌표정보 사용
            - 작은 이미지에 유용: 아이콘, 버튼,,,
## 2. 콘텐츠 파일 크기 줄이기
- 파일 수 줄여도 파일 크기 클시 웹 성능에 부정적영향
- 페이지 콘텐츠 유지하며 콘텐츠 파일 크기 줄이는 방법
    1. 스크립트 파일 압축 전달
        - 스크립트 형태의 텍스트 파일: HTML, JS, CSS, Ajax, XML, JSON,,,
        - 웹 서버가 스크립트 형태 콘텐츠 압축해 클라이언트에게 전달, 클라이언트가 압축해제해 콘텐츠 이용
        - >웹서버-클라이언트 서로가 지원하는 압축방식 중 하나 선택: HTTP헤더 이용
            - 클라이언트 요청헤더; Accept-Encoding
                - ex) ```Accept-Encoding: gzip, deflate, sdch #브라우저가 지원하는 압축방식```
            - 웹 서버 응답헤더; Content-Encoding
                - ex) ```Content-Encoding: gzip #클라이언트가 지원하는 압축방식 중 gzip선택```
            - 압축방식
                - gzip: UNIX OS에서 일반적으로 사용하는 LZ77 파일압축 라이브러리 사용
                - deflate: zlib 파일압축 라이브러리 사용
                - sdch: 구글의 HTTP상의 압축 방식, 크롬 브라우저에서 이용
    2. 스크립트 파일 최소화
        - 코딩된 스크립트 파일(HTML, JS, CSS)의 주석, 공백, 개행문자 등 로직에 영향없는 부분 제거해 전반적인 크기 줄이는 방식
        - Minify 사이트: 파일 최소화 기법 적용 사이트
        - 지속적인 업데이트 필요시 최소화된 파일로 작업 어려움
        - 개발서버와 운영서버 분리
            - 개발 서버: 스크립트 원본파일두고 개발
            - 운영 서버: 로직 테스트, 검증작업 완료 후 스크립트 최소화된 파일 이용
        - >스크립트 파일 최소화 후 압축하는 방식 이용
    3. 이미지 파일 압축
        - 이미지파일
            - 웹 사이트에서 가장 많은 용량차지하는 콘텐츠
            - 메타 데이터 포함해 저장
            - > 메타 데이터는 사람눈에 실제 보이지않으므로 불필요한 부분 제거해 크기 감소
            - !메타 데이터: 촬영한 카메라, 해상도와 같은 파일 정보
        - tinypng 사이트: 손실 압축 방식으로 이미지 파일 압축
    4. 브라우저가 선호하는 이미지 포맷 사용
        - 구글의 크롬
            > WebP: 손실압축 방식 사용하는 이미지 형식
            - JPEG이미지 형식 대체위해 웹 사이트 트래픽 감소&로딩 속도 단축 목표
            - 압축효과 높고 화질저하 최소화하면서 파일크기 줄임
        - 마이크로소프트의 인터넷익스플로러
            > JPEG XR: JPEG형식에 장점 추가해 개발한 손실압축, 비손실압축 모두 지원하는 이미지 압축 형식
        - 1)웹서버에서 동일 이미지 각 형식으로 모두 준비해 브라우저에 맞는 방식의 포맷으로 전달
        - 2)JPEG원본 이미지만 저장후 요청 브라우저에 맞게 변환해 전달
    5. 큰 파일은 작게 나누어 전송
        - 큰 파일의 일부분을 순서대로 다운로드하는 부분요청응답 방식
        - 웹 서버가 실시간으로 생성, 갱신하므로 크기 가늠불가한 콘텐츠 전송시 이용
        - 웹 서버에 특정부분파일 전달을 지원하는 기능있을 시만 사용가능
        - 웹 서버의 부분 응답 지원 확인하는 방법
            - ```curl -I http://www.exam.com/bigfile.jpg```
            - <code> HTTP/1.1 200 OK</code> 
            - <code>Accept-Range: bytes Content-Length: 5000000</code>
            - >Accept-Range: bytes = byte단위로 파일의 부분 지원기능 수락
               Content-Length: 5000000 = 해당 파일의 전체크기정보를 클라이언트에게 알림
        - 클라이언트가 특정부분만 요청하는 방법
            - ```curl -v http://www.exam.com/bigfile.jpg -H "Range: bytes=0-1023"```
            - <code> HTTP/1.1 206 Partial Content</code> 
            - <code>Content-Range: bytes 0-1023/5000000 Content-Length: 1024</code>
            - >Content-Range: bytes 0-1023/5000000 = 전체파일범위 중 처음부터 1023byte만 전달
               Content-Length: 1024 = 전달한 부분 파일의 전체용량이 시작위치,끝위치 알려주는 데이터 포함해 1024byte임을 명시
            > 동영상 플레이어의 조정바 만들 시 이용가능한 정보
        - 클라이언트가 구간별로 부분 파일요청 반복해 콘텐츠 끊김없이 서비스
        > 큰 파일에서 필요한 부분만 요청, 전달
        - 파일의 다운로드 속도 증가
        - 사용하지 않는 구간의 콘텐츠 낭비않도록 함